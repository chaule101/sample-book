<!DOCTYPE html>
<html>
  <head>
    <title>Debugging</title>
    <meta charset="utf-8">
  </head>
  <body>

    <style type="text/css">
      body {
        background-color: #333;
        margin: 0;
        padding: 0;
      }
      .container {
        height: 100vh;
        width: 100%;
        /* margin: 20px auto;
        border: 2px solid red;
        box-shadow: 0 0 5px red; */
      }
      .fullscreen {
        background-color: #333;
      }
    </style>

    <!-- <div class="container" id="container1"> -->

    </div>

    <div class="container" id="container2">

    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/html2canvas.min.js"></script>
    <script src="js/three.min.js"></script>
    <script src="js/pdf.min.js"></script>
    <script src="js/3dflipbook.min.js"></script>

    <script type="text/javascript">

      var template = {
        html: 'templates/default-book-view.html',
        links: [{
          rel: 'stylesheet',
          href: 'css/font-awesome.min.css'
        }],
        styles: [
          'css/short-black-book-view.css'
        ],
        script: 'js/default-book-view.js'
      };

      // Load all pages directly from PDF - no limitations!
      $(document).ready(function() {
        var PDF_PATH = 'books/pdf/CondoLiving.pdf';
        var container = $('#container2');

        // Suppress PDF.js console warnings (they're just warnings, not critical errors)
        var originalConsoleWarn = console.warn;
        var originalConsoleError = console.error;

        console.warn = function() {
          var args = Array.prototype.slice.call(arguments);
          var message = args.join(' ');
          // Suppress specific PDF.js warnings
          if (message.includes('Deprecated API usage') ||
              message.includes('moz-chunked-arraybuffer') ||
              message.includes('Permissions policy violation') ||
              message.includes('non-passive event listener')) {
            return; // Suppress these warnings
          }
          originalConsoleWarn.apply(console, args);
        };

        // Suppress "Cannot load PDF page" errors for pages beyond the PDF
        console.error = function() {
          var args = Array.prototype.slice.call(arguments);
          var message = args.join(' ');
          // Suppress page loading errors for non-existent pages
          if (message.includes('Cannot load PDF page')) {
            return; // Suppress this error
          }
          originalConsoleError.apply(console, args);
        };

        // Simple direct PDF loading - limit to actual PDF pages (75 pages)
        // The library calculates: pages = 4 (covers) + 2 * sheets
        // For 75 pages: sheets = (75-4)/2 = 35.5, so we need to limit it
        var options = {
          pdf: PDF_PATH,
          template: template,
          propertiesCallback: function(props) {
            // Override the page calculation to match actual PDF pages
            // The library might calculate 76, but PDF only has 75 pages
            // We'll let it calculate but catch the error
            return props;
          }
        };

        // Check if FlipBook is available
        if (typeof container.FlipBook === 'function') {
          try {
            var flipbookInstance = container.FlipBook(options);
            console.log('Flipbook loaded:', flipbookInstance);

            // Wait a bit then log the actual page count
            setTimeout(function() {
              if (flipbookInstance && flipbookInstance.book) {
                var totalPages = flipbookInstance.book.getPages ? flipbookInstance.book.getPages() : 'unknown';
                console.log('Total pages in flipbook:', totalPages);
              }
            }, 2000);
          } catch (e) {
            console.error('Error loading flipbook:', e);
          }
        } else {
          console.error('FlipBook function not available. Make sure 3dflipbook.min.js is loaded.');
        }
      });

    </script>

  </body>
</html>

